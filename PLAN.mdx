
---

# Implement List View with Upvote and Distance Sorting (Issue #5)

## Objective
Transform the left sidebar into a dedicated location browsing list with sortable views. Move map metadata (title, description, contributors) to a compact info bar at the bottom-right of the map. This prioritizes the primary user action (browsing locations) while keeping map context accessible on-demand.

## Rationale
- **Correct Priority**: Location browsing is the primary action, gets full sidebar height
- **Google Maps Pattern**: Left = list, Right = map (proven, intuitive mental model)
- **Progressive Disclosure**: Map metadata is contextual, shown on-demand via info bar
- **Maximum Browsing Space**: No scrolling past map info to see locations
- **Clean Separation**: Sidebar = location list only, Info bar = map metadata
- **User Testing Signal**: Testers instinctively expected list in the sidebar

## UI Design

### Layout
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Locations List â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Map â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Parties this weekend              â”‚  â”‚                              â”‚
â”‚ Sort: [Upvotes] [Distance]        â”‚  â”‚                              â”‚
â”‚                                   â”‚  â”‚      [pins on map]           â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚                              â”‚
â”‚ â”‚ Castle Party       ğŸ”¼ 42  â”‚     â”‚  â”‚                              â”‚
â”‚ â”‚ 1.2 km away               â”‚     â”‚  â”‚                              â”‚
â”‚ â”‚ [photo]                   â”‚     â”‚  â”‚                              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚                              â”‚
â”‚                                   â”‚  â”‚                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚                              â”‚
â”‚ â”‚ Another Party      ğŸ”¼ 38  â”‚     â”‚  â”‚                              â”‚
â”‚ â”‚ 2.1 km away               â”‚     â”‚  â”‚                              â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚                              â”‚
â”‚                                   â”‚  â”‚                              â”‚
â”‚ ... (scrollable list)             â”‚  â”‚                              â”‚
â”‚                                   â”‚  â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                              â”‚
                                       â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                                       â”‚  â”‚ â„¹ï¸ Map Info  [expand] â”‚  â”‚
                                       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Component Specifications

**Left Sidebar (Location List)**
- Full height dedicated to location browsing
- Sort controls at top: "Upvotes" or "Distance"
- Vertical scrollable list of location cards
- Each card shows: name, photo, upvotes, distance (if available)
- Click card â†’ highlight pin on map

**Info Bar (Map Metadata)**
- Position: Bottom-right of map, floating above map
- Collapsed state (default): `â„¹ï¸ Parties this weekend Â· 42 locations Â· [expand]`
- Click to expand â†’ modal or slide-out panel
- Expanded shows: Full description, contributors, photos, "Contribute" button
- Minimal footprint when collapsed

## Checkpoints

### 1. Analyze existing sidebar structure
Review current implementation:
- Examine sidebar in `app/maps/[slug]/ClientMapPageComponent.tsx`
- Identify map metadata section (title, description, contributors, images, contribute button)
- Check location data structure and available fields (upvotes, coordinates, etc.)
- Review user location context from Issue #6 implementation
- Map out what moves to info bar vs what stays in sidebar

### 2. Create location card component
Build vertical card component for sidebar list:
- Create `components/map/LocationCard.tsx`
- Display: location name, thumbnail photo, upvotes, distance (if available)
- Include click handler to highlight corresponding map pin
- Compact vertical layout optimized for sidebar width
- Responsive design for mobile full-width

### 3. Restructure sidebar for location list
Transform sidebar into dedicated location list:
- Remove map metadata section from sidebar (title, description, etc.)
- Add sort controls at top: Toggle between "Upvotes" and "Distance"
- Render vertical scrollable list of `LocationCard` components
- Implement sort logic: upvotes (descending) or distance (ascending)
- Disable distance sort if user location unavailable (show tooltip)
- Handle empty state (no locations)

### 4. Create map info bar component
Build floating info bar for map metadata:
- Create `components/map/MapInfoBar.tsx`
- Collapsed state: Compact bar with map title, location count, expand button
- Position: Absolute, bottom-right of map area
- Minimal design: `â„¹ï¸ {mapTitle} Â· {locationCount} locations Â· [ChevronUp icon]`
- Click handler to toggle expanded state

### 5. Create map info modal/panel
Build expanded view for map metadata:
- Use shadcn Dialog component or create slide-out panel
- Show full map description, cover images, contributors list
- Include "Contribute a Location" button
- Close button to return to collapsed state
- Responsive: Full-screen on mobile, dialog on desktop

### 6. Integrate components into map page
Wire up new layout in `ClientMapPageComponent.tsx`:
- Replace sidebar content with location list component
- Add `MapInfoBar` component to map area (absolute positioned)
- Pass map metadata to info bar/modal components
- Manage info bar expanded/collapsed state
- Pass location selection handler to cards (highlight pins)
- Ensure no layout overlap or z-index conflicts

### 7. Implement pin-to-card interactions
Connect map pins with sidebar cards:
- Clicking a card highlights the corresponding pin on map
- Optional: Clicking a pin scrolls to the corresponding card in sidebar
- Add visual highlight state to both card and pin
- Smooth scrolling to cards when pin clicked
- Handle edge cases (card not in viewport, etc.)

### 8. Polish and responsive design
Finalize UI and test across devices:
- Test location list scrolling with many locations (50+)
- Verify sort toggle reflects current state visually
- Test with no user location (distance sort disabled)
- Ensure info bar works on mobile (responsive positioning)
- Test info modal on mobile vs desktop
- Add loading states for location data
- Ensure accessibility (keyboard navigation, ARIA labels, focus management)

## Implementation Notes
- **Reuse existing logic**: Distance calculations and user location context already exist from Issue #6
- **Sidebar becomes single-purpose**: Dedicated to location browsing only
- **Info bar is progressive disclosure**: Map metadata accessible but not blocking primary action
- **State management**: Info bar expanded/collapsed, sort mode, selected location can be local state
- **Component reuse**: Use shadcn Dialog for info modal, existing card patterns for location cards
- **Default state**: Info bar collapsed, sorted by upvotes
- **Mobile adaptation**: Sidebar becomes full-screen list, info bar floats at bottom

## Success Criteria
- âœ… Left sidebar shows location list immediately (no map metadata)
- âœ… Location cards display vertically in scrollable sidebar
- âœ… Sort toggle switches between upvotes and distance
- âœ… Distance sort only available when user location exists
- âœ… Map info bar appears at bottom-right of map (collapsed by default)
- âœ… Clicking info bar expands to show full map metadata
- âœ… Clicking a location card highlights the corresponding map pin
- âœ… Optional: Clicking a pin scrolls to the card in sidebar
- âœ… No performance degradation with 50+ locations
- âœ… Works seamlessly on desktop and mobile
- âœ… Familiar UX pattern (Google Maps style left list)
